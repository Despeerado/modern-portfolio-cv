<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Font Loading Test - Dynamické načítání fontů</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .font-test {
            padding: 2rem;
            margin: 1rem 0;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .karla-font {
            font-family: 'Karla', sans-serif;
        }

        .petrona-font {
            font-family: 'Petrona', serif;
        }

        .poppins-font {
            font-family: 'Poppins', sans-serif;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-loading {
            background-color: #ffc107;
        }

        .status-success {
            background-color: #28a745;
        }

        .status-error {
            background-color: #dc3545;
        }

        .performance-metric {
            background: #e3f2fd;
            padding: 1rem;
            border-radius: 6px;
            margin: 0.5rem 0;
        }

        .log-entry {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            padding: 0.5rem;
            background: #f8f9fa;
            border-left: 3px solid #007bff;
            margin: 0.25rem 0;
        }
    </style>
</head>

<body>
    <div class="container my-5">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center mb-4">
                    <i class="fas fa-font me-2"></i>
                    Font Loading Test
                </h1>
                <p class="text-center text-muted mb-5">
                    Testování dynamického načítání Google Fonts bez hardcodovaných verzí
                </p>
            </div>
        </div>

        <!-- Font Loading Status -->
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-info-circle me-2"></i>Font Loading Status</h5>
                    </div>
                    <div class="card-body">
                        <div id="font-status">
                            <div class="mb-2">
                                <span id="karla-indicator" class="status-indicator status-loading"></span>
                                <strong>Karla:</strong> <span id="karla-status">Loading...</span>
                            </div>
                            <div class="mb-2">
                                <span id="petrona-indicator" class="status-indicator status-loading"></span>
                                <strong>Petrona:</strong> <span id="petrona-status">Loading...</span>
                            </div>
                            <div class="mb-2">
                                <span id="poppins-indicator" class="status-indicator status-loading"></span>
                                <strong>Poppins:</strong> <span id="poppins-status">Loading...</span>
                            </div>
                        </div>

                        <div class="mt-3">
                            <button id="test-fonts-btn" class="btn btn-primary btn-sm">
                                <i class="fas fa-sync-alt me-1"></i>Test všechny fonty
                            </button>
                            <button id="clear-log-btn" class="btn btn-secondary btn-sm ms-2">
                                <i class="fas fa-trash me-1"></i>Vyčistit log
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-tachometer-alt me-2"></i>Performance Metriky</h5>
                    </div>
                    <div class="card-body">
                        <div id="performance-metrics">
                            <div class="performance-metric">
                                <strong>Čas načítání:</strong> <span id="load-time">--</span>ms
                            </div>
                            <div class="performance-metric">
                                <strong>Aktivní fonty:</strong> <span id="active-fonts">0</span>
                            </div>
                            <div class="performance-metric">
                                <strong>Chyby:</strong> <span id="error-count">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Font Samples -->
        <div class="row mt-4">
            <div class="col-12">
                <h3 class="mb-3">Font Samples</h3>
            </div>

            <div class="col-md-4">
                <div class="font-test">
                    <h4 class="karla-font">Karla Font</h4>
                    <p class="karla-font">
                        Toto je ukázka fontu Karla v různých váhách.
                        <strong>Bold text</strong> a <em>italic text</em>.
                        Ideální pro body text a UI elementy.
                    </p>
                    <div class="karla-font" style="font-weight: 200;">Font weight 200</div>
                    <div class="karla-font" style="font-weight: 400;">Font weight 400</div>
                    <div class="karla-font" style="font-weight: 600;">Font weight 600</div>
                    <div class="karla-font" style="font-weight: 800;">Font weight 800</div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="font-test">
                    <h4 class="petrona-font">Petrona Font</h4>
                    <p class="petrona-font">
                        Toto je ukázka fontu Petrona - elegantní serif font
                        ideální pro nadpisy a výrazné texty.
                    </p>
                    <div class="petrona-font" style="font-weight: 100;">Font weight 100</div>
                    <div class="petrona-font" style="font-weight: 400;">Font weight 400</div>
                    <div class="petrona-font" style="font-weight: 700;">Font weight 700</div>
                    <div class="petrona-font" style="font-weight: 900;">Font weight 900</div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="font-test">
                    <h4 class="poppins-font">Poppins Font</h4>
                    <p class="poppins-font">
                        Toto je ukázka fontu Poppins - moderní sans-serif
                        používaný na ostatních stránkách.
                    </p>
                    <div class="poppins-font" style="font-weight: 300;">Font weight 300</div>
                    <div class="poppins-font" style="font-weight: 400;">Font weight 400</div>
                    <div class="poppins-font" style="font-weight: 500;">Font weight 500</div>
                    <div class="poppins-font" style="font-weight: 700;">Font weight 700</div>
                </div>
            </div>
        </div>

        <!-- Log Output -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-terminal me-2"></i>Loading Log</h5>
                    </div>
                    <div class="card-body">
                        <div id="font-log" style="max-height: 300px; overflow-y: auto;">
                            <!-- Log entries will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test URLs -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-link me-2"></i>Test URLs</h5>
                    </div>
                    <div class="card-body">
                        <p>Testovací odkazy pro různé stránky:</p>
                        <div class="btn-group-vertical d-grid gap-2 d-md-block">
                            <a href="index.html" class="btn btn-outline-primary">
                                <i class="fas fa-home me-1"></i>index.html (Karla + Petrona)
                            </a>
                            <a href="index1.html" class="btn btn-outline-success">
                                <i class="fas fa-file me-1"></i>index1.html (Poppins)
                            </a>
                            <a href="index_customized.html" class="btn btn-outline-info">
                                <i class="fas fa-file-alt me-1"></i>index_customized.html (Poppins)
                            </a>
                            <a href="_index.html" class="btn btn-outline-warning">
                                <i class="fas fa-file-code me-1"></i>_index.html (Poppins)
                            </a>
                            <a href="thank-you.html" class="btn btn-outline-secondary">
                                <i class="fas fa-check me-1"></i>thank-you.html (Poppins)
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Font Loading Test Script
        class FontLoadingTest {
            constructor() {
                this.startTime = performance.now();
                this.loadedFonts = new Set();
                this.errorCount = 0;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.monitorFontLoading();
                this.logMessage('Font loading test initialized');
            }

            setupEventListeners() {
                document.getElementById('test-fonts-btn').addEventListener('click', () => {
                    this.testAllFonts();
                });

                document.getElementById('clear-log-btn').addEventListener('click', () => {
                    this.clearLog();
                });
            }

            async testAllFonts() {
                this.logMessage('Testing all fonts...');

                const fonts = ['Karla', 'Petrona', 'Poppins'];

                for (const font of fonts) {
                    try {
                        await this.checkFontAvailability(font);
                        this.updateFontStatus(font.toLowerCase(), 'success', 'Loaded');
                        this.loadedFonts.add(font);
                    } catch (error) {
                        this.updateFontStatus(font.toLowerCase(), 'error', 'Failed');
                        this.errorCount++;
                        this.logMessage(`❌ Font ${font} failed: ${error.message}`, 'error');
                    }
                }

                this.updateMetrics();
            }

            async checkFontAvailability(fontFamily) {
                return new Promise((resolve, reject) => {
                    // Create a test element with the font
                    const testElement = document.createElement('div');
                    testElement.style.fontFamily = `${fontFamily}, monospace`;
                    testElement.style.fontSize = '100px';
                    testElement.style.position = 'absolute';
                    testElement.style.left = '-9999px';
                    testElement.textContent = 'Test';

                    document.body.appendChild(testElement);

                    const monospaceWidth = testElement.offsetWidth;

                    // Wait a bit for font to load
                    setTimeout(() => {
                        const currentWidth = testElement.offsetWidth;
                        document.body.removeChild(testElement);

                        if (currentWidth !== monospaceWidth) {
                            resolve();
                        } else {
                            reject(new Error('Font not loaded'));
                        }
                    }, 100);
                });
            }

            updateFontStatus(font, status, message) {
                const indicator = document.getElementById(`${font}-indicator`);
                const statusText = document.getElementById(`${font}-status`);

                indicator.className = `status-indicator status-${status}`;
                statusText.textContent = message;

                this.logMessage(`Font ${font}: ${message}`, status);
            }

            updateMetrics() {
                const loadTime = Math.round(performance.now() - this.startTime);
                document.getElementById('load-time').textContent = loadTime;
                document.getElementById('active-fonts').textContent = this.loadedFonts.size;
                document.getElementById('error-count').textContent = this.errorCount;
            }

            logMessage(message, type = 'info') {
                const logDiv = document.getElementById('font-log');
                const timestamp = new Date().toLocaleTimeString();
                const entry = document.createElement('div');
                entry.className = 'log-entry';

                const icon = type === 'error' ? '❌' : type === 'success' ? '✅' : 'ℹ️';
                entry.innerHTML = `<strong>[${timestamp}]</strong> ${icon} ${message}`;

                logDiv.appendChild(entry);
                logDiv.scrollTop = logDiv.scrollHeight;
            }

            clearLog() {
                document.getElementById('font-log').innerHTML = '';
                this.logMessage('Log cleared');
            }

            async monitorFontLoading() {
                // Monitor font loading via CSS font loading API if available
                if ('fonts' in document) {
                    document.fonts.addEventListener('loading', (e) => {
                        this.logMessage(`Font loading started: ${e.fontface.family}`);
                    });

                    document.fonts.addEventListener('loadingdone', (e) => {
                        this.logMessage(`Font loading completed: ${e.fontface.family}`, 'success');
                    });

                    document.fonts.addEventListener('loadingerror', (e) => {
                        this.logMessage(`Font loading error: ${e.fontface.family}`, 'error');
                        this.errorCount++;
                    });
                }

                // Check if font-loader.js is loaded
                if (window.fontLoader) {
                    this.logMessage('✅ font-loader.js detected');
                } else {
                    this.logMessage('⚠️ font-loader.js not detected - checking again in 1s');
                    setTimeout(() => {
                        if (window.fontLoader) {
                            this.logMessage('✅ font-loader.js loaded later');
                        } else {
                            this.logMessage('❌ font-loader.js missing', 'error');
                        }
                    }, 1000);
                }
            }
        }

        // Initialize test when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            window.fontTest = new FontLoadingTest();

            // Auto-test fonts after a short delay
            setTimeout(() => {
                window.fontTest.testAllFonts();
            }, 1000);
        });
    </script>

    <!-- Dynamic Font Loader -->
    <script src="js/font-loader.js?v=1749048895" defer></script>
</body>

</html>